---
title: "ë¯¸ë˜ë¥¼ ì´ëŒ ì‚°ì—…ë¶„ì•¼"
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
library(plotly)
library(scales)
library(glue)

# í…Œë§ˆ ì„¤ì •
theme_set(theme_minimal(base_size = 12))
```

## 2019ë…„~2025ë…„ ì‹¤ì—…ë¥  ë° ì·¨ì—…ì ì¶”ì´

::: {.panel-tabset}

### 20ëŒ€ ì‹¤ì—…ë¥  ì¶”ì´

```{r echo=FALSE, message=FALSE, warning=FALSE}
#| fig-width: 10
#| fig-height: 6

# í•„ìš”í•œ íŒ¨í‚¤ì§€ ë¡œë“œ
library(dplyr)
library(plotly)
library(readr)

# ë°ì´í„° ì½ê¸° (EUC-KR ì¸ì½”ë”©)
df <- read_csv("ì—°ë ¹ë³„_ê²½ì œí™œë™ì¸êµ¬_ì´ê´„_20251209103015.csv", 
               locale = locale(encoding = "EUC-KR"),
               col_names = FALSE)

# ë°ì´í„° ì¬êµ¬ì¡°í™”
periods <- as.character(df[1, -1])
indicators <- as.character(df[2, -1])
values <- as.character(df[3, -1])

# ë°ì´í„°í”„ë ˆì„ ìƒì„±
data_df <- data.frame(
  period = periods,
  indicator = indicators,
  value = values,
  stringsAsFactors = FALSE
)

# ìˆ«ìë¡œ ë³€í™˜
data_df$value <- as.numeric(data_df$value)

# ê° ì§€í‘œë³„ë¡œ ë¶„ë¦¬ ë° ê·¸ë£¹í™”
df_employed <- data_df %>% 
  filter(indicator == "ì·¨ì—…ì (ì²œëª…)") %>%
  group_by(period) %>%
  summarise(value = first(value), .groups = 'drop')

df_unemployment <- data_df %>% 
  filter(indicator == "ì‹¤ì—…ë¥  (%)") %>%
  group_by(period) %>%
  summarise(value = first(value), .groups = 'drop')

df_employment <- data_df %>% 
  filter(indicator == "ê³ ìš©ë¥  (%)") %>%
  group_by(period) %>%
  summarise(value = first(value), .groups = 'drop')

# plotly ê·¸ë˜í”„ ìƒì„± (ì´ì¤‘ yì¶•)
plot_ly() %>%
  # ì·¨ì—…ì ìˆ˜ (ì™¼ìª½ yì¶•)
  add_trace(
    data = df_employed,
    x = ~period,
    y = ~value,
    type = 'scatter',
    mode = 'lines+markers',
    name = 'ì·¨ì—…ì ìˆ˜',
    line = list(color = '#1f77b4', width = 2.5),
    marker = list(size = 6),
    yaxis = 'y',
    hovertemplate = paste(
      '<b>ì·¨ì—…ì ìˆ˜</b><br>',
      '%{y:.0f}ì²œëª…',
      '<extra></extra>'
    )
  ) %>%
  # ì‹¤ì—…ë¥  (ì˜¤ë¥¸ìª½ yì¶•)
  add_trace(
    data = df_unemployment,
    x = ~period,
    y = ~value,
    type = 'scatter',
    mode = 'lines+markers',
    name = 'ì‹¤ì—…ë¥ ',
    line = list(color = '#ff7f0e', width = 2.5),
    marker = list(size = 6),
    yaxis = 'y2',
    hovertemplate = paste(
      '<b>ì‹¤ì—…ë¥ </b><br>',
      '%{y:.1f}%',
      '<extra></extra>'
    )
  ) %>%
  # ê³ ìš©ë¥  (ì˜¤ë¥¸ìª½ yì¶•)
  add_trace(
    data = df_employment,
    x = ~period,
    y = ~value,
    type = 'scatter',
    mode = 'lines+markers',
    name = 'ê³ ìš©ë¥ ',
    line = list(color = '#2ca02c', width = 2.5),
    marker = list(size = 6),
    yaxis = 'y2',
    hovertemplate = paste(
      '<b>ê³ ìš©ë¥ </b><br>',
      '%{y:.1f}%',
      '<extra></extra>'
    )
  ) %>%
  # ë ˆì´ì•„ì›ƒ ì„¤ì •
  layout(
    title = list(
      text = "<b>15-29ì„¸ ê²½ì œí™œë™ì¸êµ¬ ì´ê´„</b><br><sub>2010ë…„ ~ 2024ë…„</sub>",
      font = list(size = 18, family = "Malgun Gothic")
    ),
    xaxis = list(
      title = "ì—°ë„",
      tickformat = ".0f",
      dtick = 2,
      gridcolor = 'rgba(200,200,200,0.3)'
    ),
    yaxis = list(
      title = "ì·¨ì—…ì ìˆ˜ (ì²œëª…)",
      titlefont = list(color = '#1f77b4', family = "Malgun Gothic"),
      tickfont = list(color = '#1f77b4'),
      gridcolor = 'rgba(200,200,200,0.3)'
    ),
    yaxis2 = list(
      title = "ì‹¤ì—…ë¥  / ê³ ìš©ë¥  (%)",
      titlefont = list(color = '#ff7f0e', family = "Malgun Gothic"),
      tickfont = list(color = '#ff7f0e'),
      overlaying = 'y',
      side = 'right',
      showgrid = FALSE
    ),
    hovermode = 'closest',
    plot_bgcolor = 'rgba(240,240,240,0.3)',
    paper_bgcolor = 'white',
    font = list(family = "Malgun Gothic, sans-serif", size = 10),
    legend = list(
      title = list(text = "<b>ì§€í‘œ</b>"),
      orientation = "v",
      x = 1.02,
      y = 1,
      bgcolor = 'rgba(255,255,255,0.9)',
      bordercolor = 'rgba(0,0,0,0.3)',
      borderwidth = 1
    ),
    margin = list(l = 60, r = 120, t = 80, b = 60)
  ) %>%
  config(displayModeBar = TRUE, locale = 'ko')
```

### ì •ë³´í†µì‹ ì—… ì·¨ì—…ì ì¶”ì´

```{r echo=FALSE, message=FALSE, warning=FALSE}
#| fig-width: 10
#| fig-height: 6

# ë°ì´í„° ì½ê¸°
df_it <- read_csv("ì‚°ì—…ë³„_ì·¨ì—…ì_20251208132018.csv", 
                  locale = locale(encoding = "EUC-KR"))

# ë¶„ê¸°ë³„ ë°ì´í„° ì—´ ì´ë¦„ ì„ íƒ
quarter_cols_it <- colnames(df_it)[grepl("\\d{4}\\.\\d/4", colnames(df_it))]

df_long_it <- df_it %>%
  select(ì‚°ì—…ë³„, all_of(quarter_cols_it)) %>%
  filter(grepl("J.*ì •ë³´í†µì‹ ", ì‚°ì—…ë³„)) %>%
  pivot_longer(
    cols = all_of(quarter_cols_it),
    names_to = "ë¶„ê¸°",
    values_to = "ì·¨ì—…ììˆ˜"
  ) %>%
  mutate(
    ë…„ë„ = as.numeric(str_extract(ë¶„ê¸°, "^\\d{4}")),
    ë¶„ê¸°ë²ˆí˜¸ = as.numeric(str_extract(ë¶„ê¸°, "(?<=\\.)\\d(?=/4)")),
    ì‹œì  = ë…„ë„ + (ë¶„ê¸°ë²ˆí˜¸ - 1) * 0.25,
    ë¶„ê¸°ë¼ë²¨ = paste0(ë…„ë„, "ë…„ ", ë¶„ê¸°ë²ˆí˜¸, "ë¶„ê¸°")
  ) %>%
  arrange(ì‹œì )

# ì •ë³´í†µì‹ ì—… ì·¨ì—…ì ìˆ˜ ì¶”ì´ ê·¸ë˜í”„
plot_ly(data = df_long_it,
        x = ~ì‹œì ,
        y = ~ì·¨ì—…ììˆ˜,
        type = 'scatter',
        mode = 'lines+markers',
        line = list(width = 2.5, color = '#1f77b4'),
        marker = list(size = 6, color = '#1f77b4'),
        name = 'ì •ë³´í†µì‹ ì—…',
        hovertemplate = paste(
          '<b>ì •ë³´í†µì‹ ì—…</b><br>',
          'ì‹œì : %{customdata[0]}<br>',
          'ì·¨ì—…ì ìˆ˜: %{y:,.0f}ì²œëª…',
          '<extra></extra>'
        ),
        customdata = ~ë¶„ê¸°ë¼ë²¨) %>%
  layout(
    title = list(
      text = "<b>ì •ë³´í†µì‹ ì—… ì·¨ì—…ì ìˆ˜ ì¶”ì´</b><br><sub>2019ë…„ 1ë¶„ê¸° ~ 2025ë…„ 3ë¶„ê¸°</sub>",
      font = list(size = 18, family = "Malgun Gothic")
    ),
    xaxis = list(
      title = "ì—°ë„", 
      tickformat = ".0f", 
      dtick = 1,
      gridcolor = 'rgba(200,200,200,0.3)'
    ),
    yaxis = list(
      title = "ì·¨ì—…ì ìˆ˜ (ì²œëª…)", 
      separatethousands = TRUE,
      gridcolor = 'rgba(200,200,200,0.3)'
    ),
    hovermode = 'x unified',
    plot_bgcolor = 'rgba(240,240,240,0.3)',
    paper_bgcolor = 'white',
    font = list(family = "Malgun Gothic, sans-serif", size = 10),
    showlegend = FALSE,
    margin = list(l = 60, r = 60, t = 80, b = 60)
  ) %>%
  config(displayModeBar = TRUE, locale = 'ko')
```

:::


## ë°ì´í„° ì‚°ì—… ë¶„ì•¼ ì¸ë ¥ ë¶€ì¡±ë¥ 

::: {.panel-tabset}

### ì¸ë ¥ ë¶€ì¡±ë¥  ì¶”ì´

```{r echo=FALSE, message=FALSE, warning=FALSE}
#| fig-width: 10
#| fig-height: 6

# ë°ì´í„° ì½ê¸° (skip=1ë¡œ ì²« ë²ˆì§¸ í—¤ë” í–‰ ê±´ë„ˆë›°ê¸°)
df_raw <- read_csv("í–¥í›„_5ë…„_ë‚´_ë°ì´í„°ì‚°ì—…ì˜_ë°ì´í„°ì§ë¬´_ì¸ë ¥_ë¶€ì¡±ë¥ _20251208145057.csv",
                   locale = locale(encoding = "EUC-KR"),
                   skip = 1)  # ì²« ë²ˆì§¸ í—¤ë” í–‰ ê±´ë„ˆë›°ê¸°

# ì—´ ì´ë¦„ ì •ë¦¬
colnames(df_raw)[1] <- "ì§ë¬´"

# ë‘ ë²ˆì§¸ ì—´ë¶€í„°ëŠ” ì‚°ì—…êµ¬ë¶„_ì—°ë„ í˜•íƒœë¡œ ë˜ì–´ ìˆìŒ
# ê° ì—°ë„ë§ˆë‹¤ 4ê°œì˜ ì‚°ì—…êµ¬ë¶„ì´ ìˆìŒ (ì „ì²´, ë°ì´í„° ì²˜ë¦¬, ë°ì´í„° êµ¬ì¶•, ë°ì´í„° íŒë§¤)

# ì—°ë„ ì •ë³´ë¥¼ ë³„ë„ë¡œ ì½ê¸°
year_header <- read_lines("í–¥í›„_5ë…„_ë‚´_ë°ì´í„°ì‚°ì—…ì˜_ë°ì´í„°ì§ë¬´_ì¸ë ¥_ë¶€ì¡±ë¥ _20251208145057.csv",
                          locale = locale(encoding = "EUC-KR"),
                          n_max = 1)
years <- str_split(year_header, ",")[[1]][-1]  # ì²« ì»¬ëŸ¼ ì œì™¸
years <- as.integer(years)

# ì‚°ì—…êµ¬ë¶„ ì •ë³´
industry_header <- read_lines("í–¥í›„_5ë…„_ë‚´_ë°ì´í„°ì‚°ì—…ì˜_ë°ì´í„°ì§ë¬´_ì¸ë ¥_ë¶€ì¡±ë¥ _20251208145057.csv",
                             locale = locale(encoding = "EUC-KR"),
                             skip = 1,
                             n_max = 1)
industries <- str_split(industry_header, ",")[[1]][-1]

# ë°ì´í„° ì¬êµ¬ì¡°í™”
df_long <- df_raw %>%
  select(-1) %>%  # ì§ë¬´ ì—´ ì œì™¸
  t() %>%  # ì „ì¹˜
  as.data.frame() %>%
  mutate(
    ì—°ë„ = years,
    ì‚°ì—…êµ¬ë¶„ = industries
  )

# ì—´ ì´ë¦„ì„ ì§ë¬´ëª…ìœ¼ë¡œ ì„¤ì •
colnames(df_long)[1:(ncol(df_long)-2)] <- df_raw$ì§ë¬´

# Long í˜•ì‹ìœ¼ë¡œ ë³€í™˜
df_long <- df_long %>%
  pivot_longer(
    cols = -c(ì—°ë„, ì‚°ì—…êµ¬ë¶„),
    names_to = "ì§ë¬´",
    values_to = "ë¶€ì¡±ë¥ "
  ) %>%
  mutate(
    ë¶€ì¡±ë¥  = as.numeric(ë¶€ì¡±ë¥ )
  )

# í‰ê·  ë°ì´í„°ë§Œ ì¶”ì¶œ (ì „ì²´ ì‚°ì—…êµ¬ë¶„)
df_avg <- df_long %>%
  filter(ì§ë¬´ == "í‰ê· ", ì‚°ì—…êµ¬ë¶„ == "ì „ì²´") %>%
  group_by(ì—°ë„) %>%
  summarise(ë¶€ì¡±ë¥  = mean(ë¶€ì¡±ë¥ , na.rm = TRUE), .groups = 'drop')

# ë¼ì¸ ì°¨íŠ¸
plot_ly(
  data = df_avg,
  x = ~ì—°ë„,
  y = ~ë¶€ì¡±ë¥ ,
  type = 'scatter',
  mode = 'lines+markers',
  line = list(color = '#FF6B6B', width = 4),
  marker = list(size = 10, color = '#FF6B6B'),
  text = ~paste0(round(ë¶€ì¡±ë¥ , 1), "%"),
  hovertemplate = paste(
    '<b>%{x}ë…„</b><br>',
    'ì¸ë ¥ ë¶€ì¡±ë¥ : <b>%{y:.1f}%</b><br>',
    '<extra></extra>'
  )
) %>%
  layout(
    title = list(
      text = "<b>ë°ì´í„° ì‚°ì—… ì¸ë ¥ ë¶€ì¡±ë¥  ì¶”ì´</b>",
      font = list(size = 20, family = "Malgun Gothic", color = "#2C3E50")
    ),
    xaxis = list(
      title = "<b>ì—°ë„</b>",
      dtick = 1,
      gridcolor = 'rgba(200,200,200,0.3)',
      titlefont = list(size = 14)
    ),
    yaxis = list(
      title = "<b>ì¸ë ¥ ë¶€ì¡±ë¥  (%)</b>",
      gridcolor = 'rgba(200,200,200,0.3)',
      range = c(0, max(df_avg$ë¶€ì¡±ë¥ , na.rm = TRUE) + 3),
      titlefont = list(size = 14)
    ),
    plot_bgcolor = 'rgba(240,245,250,0.8)',
    paper_bgcolor = 'white',
    font = list(family = "Malgun Gothic, sans-serif", size = 12),
    margin = list(l = 80, r = 50, t = 100, b = 80)
  ) %>%
  config(displayModeBar = FALSE, locale = 'ko')
```

### ì§ë¬´ë³„ ë¶€ì¡±ë¥ 

```{r echo=FALSE, message=FALSE, warning=FALSE}
#| fig-width: 10
#| fig-height: 7

# ì§ë¬´ë³„ ë°ì´í„° (í‰ê·  ì œì™¸, ì „ì²´ ì‚°ì—…êµ¬ë¶„ë§Œ)
df_jobs <- df_long %>%
  filter(ì§ë¬´ != "í‰ê· ", ì‚°ì—…êµ¬ë¶„ == "ì „ì²´") %>%
  group_by(ì—°ë„, ì§ë¬´) %>%
  summarise(ë¶€ì¡±ë¥  = mean(ë¶€ì¡±ë¥ , na.rm = TRUE), .groups = 'drop')

# ì• ë‹ˆë©”ì´ì…˜ ë§‰ëŒ€ ì°¨íŠ¸
plot_ly(
  data = df_jobs,
  x = ~ë¶€ì¡±ë¥ ,
  y = ~reorder(ì§ë¬´, ë¶€ì¡±ë¥ ),
  frame = ~ì—°ë„,
  type = 'bar',
  orientation = 'h',
  marker = list(
    color = ~ë¶€ì¡±ë¥ ,
    colorscale = list(
      c(0, 'rgb(255,245,235)'),
      c(0.5, 'rgb(254,201,129)'),
      c(1, 'rgb(227,74,51)')
    ),
    showscale = FALSE
  ),
  text = ~paste0(round(ë¶€ì¡±ë¥ , 1), "%"),
  textposition = 'outside',
  hovertemplate = paste(
    '<b>%{y}</b><br>',
    'ì¸ë ¥ ë¶€ì¡±ë¥ : <b>%{x:.1f}%</b><br>',
    '<extra></extra>'
  )
) %>%
  layout(
    title = list(
      text = "<b>ë°ì´í„° ì§ë¬´ë³„ ì¸ë ¥ ë¶€ì¡±ë¥ </b>",
      font = list(size = 20, family = "Malgun Gothic", color = "#2C3E50")
    ),
    xaxis = list(
      title = "<b>ì¸ë ¥ ë¶€ì¡±ë¥  (%)</b>",
      range = c(0, max(df_jobs$ë¶€ì¡±ë¥ , na.rm = TRUE) + 5),
      gridcolor = 'rgba(200,200,200,0.3)',
      titlefont = list(size = 14)
    ),
    yaxis = list(
      title = "",
      titlefont = list(size = 14)
    ),
    plot_bgcolor = 'rgba(240,245,250,0.8)',
    paper_bgcolor = 'white',
    font = list(family = "Malgun Gothic, sans-serif", size = 12),
    margin = list(l = 180, r = 80, t = 100, b = 120)
  ) %>%
  animation_opts(
    frame = 500,
    transition = 300,
    easing = "elastic",
    redraw = FALSE
  ) %>%
  animation_slider(
    currentvalue = list(
      prefix = "ì—°ë„: ",
      font = list(size = 16, color = "#E74C3C")
    ),
    pad = list(t = 50)
  ) %>%
  config(displayModeBar = FALSE, locale = 'ko')
```

### 2024ë…„ í˜„í™©

```{r echo=FALSE, message=FALSE, warning=FALSE}
#| fig-width: 10
#| fig-height: 7

# 2024ë…„ ë°ì´í„°
df_2024 <- df_jobs %>%
  filter(ì—°ë„ == 2024) %>%
  arrange(desc(ë¶€ì¡±ë¥ ))

# 2024ë…„ ë§‰ëŒ€ ì°¨íŠ¸
plot_ly(
  data = df_2024,
  y = ~reorder(ì§ë¬´, ë¶€ì¡±ë¥ ),
  x = ~ë¶€ì¡±ë¥ ,
  type = 'bar',
  orientation = 'h',
  marker = list(
    color = ~ë¶€ì¡±ë¥ ,
    colorscale = list(
      c(0, 'rgb(255,245,235)'),
      c(0.3, 'rgb(254,201,129)'),
      c(0.6, 'rgb(241,128,74)'),
      c(1, 'rgb(227,74,51)')
    ),
    line = list(color = 'rgb(8,48,107)', width = 1.5)
  ),
  text = ~paste0("<b>", round(ë¶€ì¡±ë¥ , 1), "%</b>"),
  textposition = 'outside',
  textfont = list(size = 14, color = '#2C3E50'),
  hovertemplate = paste(
    '<b>%{y}</b><br>',
    'ì¸ë ¥ ë¶€ì¡±ë¥ : <b>%{x:.1f}%</b><br>',
    '<extra></extra>'
  )
) %>%
  layout(
    title = list(
      text = "<b>2024ë…„ ë°ì´í„° ì§ë¬´ë³„ ì¸ë ¥ ë¶€ì¡±ë¥ </b>",
      font = list(size = 20, family = "Malgun Gothic", color = "#2C3E50")
    ),
    xaxis = list(
      title = "<b>ì¸ë ¥ ë¶€ì¡±ë¥  (%)</b>",
      range = c(0, max(df_2024$ë¶€ì¡±ë¥ , na.rm = TRUE) + 5),
      gridcolor = 'rgba(200,200,200,0.3)',
      titlefont = list(size = 14)
    ),
    yaxis = list(
      title = "",
      titlefont = list(size = 14)
    ),
    plot_bgcolor = 'rgba(240,245,250,0.8)',
    paper_bgcolor = 'white',
    font = list(family = "Malgun Gothic, sans-serif", size = 13),
    margin = list(l = 180, r = 80, t = 120, b = 80)
  ) %>%
  config(displayModeBar = FALSE, locale = 'ko')
```

:::

### ë°ì´í„° ì‚°ì—… ë¶„ì•¼ ì£¼ìš” ë°œê²¬ì 

```{r echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
latest_year <- max(df_avg$ì—°ë„, na.rm = TRUE)
latest_rate <- df_avg %>% filter(ì—°ë„ == latest_year) %>% pull(ë¶€ì¡±ë¥ )
first_year <- min(df_avg$ì—°ë„, na.rm = TRUE)
first_rate <- df_avg %>% filter(ì—°ë„ == first_year) %>% pull(ë¶€ì¡±ë¥ )
avg_rate <- mean(df_avg$ë¶€ì¡±ë¥ , na.rm = TRUE)

if(nrow(df_2024) > 0) {
  top_job <- df_2024$ì§ë¬´[1]
  top_rate <- df_2024$ë¶€ì¡±ë¥ [1]
  
  cat(paste0(
    "- **", latest_year, "ë…„ ê¸°ì¤€ ì „ì²´ í‰ê·  ì¸ë ¥ ë¶€ì¡±ë¥ **: ", round(latest_rate, 1), "%\n",
    "- **", first_year, "~", latest_year, "ë…„ í‰ê· **: ", round(avg_rate, 1), "%\n",
    "- **ê°€ì¥ ë¶€ì¡±í•œ ì§ë¬´**: ", top_job, " (", round(top_rate, 1), "%)\n",
    "- **ì¦ê°€ ì¶”ì„¸**: ", first_year, "ë…„ ", round(first_rate, 1), "% â†’ ", 
    latest_year, "ë…„ ", round(latest_rate, 1), "% (", 
    round(latest_rate - first_rate, 1), "%p ë³€í™”)\n"
  ))
}
```



---

## íƒìƒ‰í•´ë³´ê¸°ğŸ¤” 

::: {.panel-tabset}

### ì§ˆë¬¸ 1
**ì—¬ëŸ¬ë¶„ì´ ê´€ì‹¬ìˆëŠ” ì§ì¢…ì˜ ìˆ˜ìš”ëŠ” ì–´ë–¤ê°€ìš”?**

ì—¬ëŸ¬ë¶„ì˜ ìƒê°ì„ ì ì–´ë³´ì„¸ìš”:
<textarea style="width:100%; height:100px; padding:10px; border:2px solid #ddd; border-radius:5px;" placeholder="ë‚´ ìƒê°ì„ ì—¬ê¸°ì— ì ì–´ë³´ì„¸ìš”..."></textarea>

### ì§ˆë¬¸ 2
**ì—¬ëŸ¬ë¶„ì´ ê´€ì‹¬ìˆëŠ” ì§ì¢…ì˜ ìˆ˜ìš”ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸ì€ ì–´ë–¤ ê²Œ ìˆì„ê¹Œìš”?**

ì—¬ëŸ¬ë¶„ì˜ ìƒê°ì„ ì ì–´ë³´ì„¸ìš”:
<textarea style="width:100%; height:100px; padding:10px; border:2px solid #ddd; border-radius:5px;" placeholder="ë‚´ ìƒê°ì„ ì—¬ê¸°ì— ì ì–´ë³´ì„¸ìš”..."></textarea>

:::

---


